<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบห้องเช่า</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .room {
            background-color: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 100%;
            max-width: 300px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .room-header {
            display: flex;
            justify-content: space-between;
            width: 100%;
            align-items: center;
            margin-bottom: 10px;
        }
        .room-header h2 {
            margin: 0;
            font-size: 1.2em;
        }
        .room-status {
            background-color: red;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .room-status.vacant {
            background-color: green;
        }
        .room-calculation {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
        }
        .room-calculation input {
            padding: 5px;
            width: 100%;
            box-sizing: border-box;
        }
        .room-actions {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }
        .room-actions button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .calculate {
            background-color: #007bff;
            color: white;
        }
        .clear {
            background-color: #dc3545;
            color: white;
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .room {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1>ระบบห้องเช่า</h1>
    <div class="container">
        <!-- ห้องเช่าจะถูกสร้างที่นี่โดย JavaScript -->
    </div>
    <script>
        const roomsContainer = document.querySelector('.container');
        const roomRent = 2000;
        const waterCharge = 50;
        const electricityRate = 6;
        const totalRooms = 20;

        function createRoomElement(index) {
            const roomDiv = document.createElement('div');
            roomDiv.classList.add('room');
            roomDiv.innerHTML = `
                <div class="room-header">
                    <h2>ห้อง ${index + 1}</h2>
                    <button class="room-status">ว่าง</button>
                </div>
                <div class="room-calculation">
                    <input type="number" placeholder="จำนวนหน่วยไฟฟ้า" class="electricity-input">
                    <input type="text" readonly placeholder="ค่าเช่า" value="${roomRent} บาท">
                    <input type="text" readonly placeholder="ค่าน้ำ" value="${waterCharge} บาท">
                    <input type="text" readonly placeholder="ค่าไฟฟ้า">
                    <input type="text" readonly placeholder="ยอดรวม">
                </div>
                <div class="room-actions">
                    <button class="calculate">คำนวณ</button>
                    <button class="clear">เคลียร์</button>
                </div>
            `;

            // โหลดสถานะห้องจาก Local Storage
            const statusButton = roomDiv.querySelector('.room-status');
            const roomStatus = localStorage.getItem(`roomStatus${index}`) || 'vacant';
            if (roomStatus === 'occupied') {
                statusButton.classList.remove('vacant');
                statusButton.classList.add('occupied');
                statusButton.textContent = 'ไม่ว่าง';
            } else {
                statusButton.classList.remove('occupied');
                statusButton.classList.add('vacant');
                statusButton.textContent = 'ว่าง';
            }

            // เปลี่ยนสถานะห้อง
            statusButton.addEventListener('click', () => {
                if (statusButton.classList.contains('vacant')) {
                    statusButton.classList.remove('vacant');
                    statusButton.classList.add('occupied');
                    statusButton.textContent = 'ไม่ว่าง';
                    localStorage.setItem(`roomStatus${index}`, 'occupied');
                } else {
                    statusButton.classList.remove('occupied');
                    statusButton.classList.add('vacant');
                    statusButton.textContent = 'ว่าง';
                    localStorage.setItem(`roomStatus${index}`, 'vacant');
                }
            });

            // คำนวณค่าใช้จ่าย
            const calculateButton = roomDiv.querySelector('.calculate');
            const electricityInput = roomDiv.querySelector('.electricity-input');
            const electricityCost = roomDiv.querySelectorAll('input')[3];
            const totalCost = roomDiv.querySelectorAll('input')[4];
            
            calculateButton.addEventListener('click', () => {
                const electricityUnits = parseFloat(electricityInput.value);
                if (isNaN(electricityUnits) || electricityUnits < 0) {
                    alert('กรุณากรอกจำนวนหน่วยไฟฟ้าที่ถูกต้อง');
                    return;
                }
                const electricityCharge = electricityUnits * electricityRate;
                electricityCost.value = `${electricityCharge} บาท`;
                const total = roomRent + waterCharge + electricityCharge;
                totalCost.value = `${total} บาท`;
                // บันทึกข้อมูลการคำนวณลง Local Storage
                localStorage.setItem(`electricityUnits${index}`, electricityUnits);
                localStorage.setItem(`electricityCharge${index}`, electricityCharge);
                localStorage.setItem(`totalCost${index}`, total);
            });

            // เคลียร์ข้อมูล
            const clearButton = roomDiv.querySelector('.clear');
            clearButton.addEventListener('click', () => {
                electricityInput.value = '';
                electricityCost.value = '';
                totalCost.value = '';
                // ลบข้อมูลจาก Local Storage
                localStorage.removeItem(`electricityUnits${index}`);
                localStorage.removeItem(`electricityCharge${index}`);
                localStorage.removeItem(`totalCost${index}`);
            });

            // โหลดข้อมูลการคำนวณจาก Local Storage ถ้ามี
            const savedElectricityUnits = localStorage.getItem(`electricityUnits${index}`);
            const savedElectricityCharge = localStorage.getItem(`electricityCharge${index}`);
            const savedTotalCost = localStorage.getItem(`totalCost${index}`);
            if (savedElectricityUnits !== null) {
                electricityInput.value = savedElectricityUnits;
                electricityCost.value = `${savedElectricityCharge} บาท`;
                totalCost.value = `${savedTotalCost} บาท`;
            }

            roomsContainer.appendChild(roomDiv);
        }

        // สร้างห้องทั้งหมด
        for (let i = 0; i < totalRooms; i++) {
            createRoomElement(i);
        }
    </script>
</body>
</html>
